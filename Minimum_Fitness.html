<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="en" xml:lang="en"><head>

<meta charset="utf-8">
<meta name="generator" content="quarto-1.3.450">

<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes">


<title>minimum_fitness</title>
<style>
code{white-space: pre-wrap;}
span.smallcaps{font-variant: small-caps;}
div.columns{display: flex; gap: min(4vw, 1.5em);}
div.column{flex: auto; overflow-x: auto;}
div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
ul.task-list{list-style: none;}
ul.task-list li input[type="checkbox"] {
  width: 0.8em;
  margin: 0 0.8em 0.2em -1em; /* quarto-specific, see https://github.com/quarto-dev/quarto-cli/issues/4556 */ 
  vertical-align: middle;
}
/* CSS for syntax highlighting */
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { display: inline-block; line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
  }
pre.numberSource { margin-left: 3em;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
</style>


<script src="Minimum_Fitness_files/libs/clipboard/clipboard.min.js"></script>
<script src="Minimum_Fitness_files/libs/quarto-html/quarto.js"></script>
<script src="Minimum_Fitness_files/libs/quarto-html/popper.min.js"></script>
<script src="Minimum_Fitness_files/libs/quarto-html/tippy.umd.min.js"></script>
<script src="Minimum_Fitness_files/libs/quarto-html/anchor.min.js"></script>
<link href="Minimum_Fitness_files/libs/quarto-html/tippy.css" rel="stylesheet">
<link href="Minimum_Fitness_files/libs/quarto-html/quarto-syntax-highlighting.css" rel="stylesheet" id="quarto-text-highlighting-styles">
<script src="Minimum_Fitness_files/libs/bootstrap/bootstrap.min.js"></script>
<link href="Minimum_Fitness_files/libs/bootstrap/bootstrap-icons.css" rel="stylesheet">
<link href="Minimum_Fitness_files/libs/bootstrap/bootstrap.min.css" rel="stylesheet" id="quarto-bootstrap" data-mode="light">

  <script src="https://polyfill.io/v3/polyfill.min.js?features=es6"></script>
  <script src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-chtml-full.js" type="text/javascript"></script>

</head>

<body class="fullcontent">

<div id="quarto-content" class="page-columns page-rows-contents page-layout-article">

<main class="content" id="quarto-document-content">



<section id="minimum-fitness" class="level1">
<h1>Minimum Fitness</h1>
<p>Shashank Pritam</p>
<ul>
<li><a href="#introduction"><span class="toc-section-number">1</span> Introduction</a></li>
<li><a href="#materials-methods"><span class="toc-section-number">2</span> Materials &amp; Methods</a>
<ul>
<li><a href="#commands-for-the-simulation"><span class="toc-section-number">2.1</span> Commands for the simulation</a></li>
<li><a href="#parameters"><span class="toc-section-number">2.2</span> Parameters</a></li>
</ul></li>
<li><a href="#visualization-in-r"><span class="toc-section-number">3</span> Visualization in R</a>
<ul>
<li><a href="#set-the-environment-by-loading-modules"><span class="toc-section-number">3.1</span> Set the environment by loading modules</a></li>
<li><a href="#load-data"><span class="toc-section-number">3.2</span> Load Data</a></li>
<li><a href="#ggplot-function-to-plot-data"><span class="toc-section-number">3.3</span> ggplot function to Plot Data</a></li>
<li><a href="#create-the-plots"><span class="toc-section-number">3.4</span> Create the plots</a></li>
</ul></li>
<li><a href="#color-scheme-in-the-plot"><span class="toc-section-number">4</span> Color Scheme in the Plot</a>
<ul>
<li><a href="#variable---min_w"><span class="toc-section-number">4.1</span> Variable - <code>min_w</code></a></li>
<li><a href="#variables---popstat"><span class="toc-section-number">4.2</span> Variables - <code>popstat</code></a></li>
</ul></li>
<li><a href="#conclusion"><span class="toc-section-number">5</span> Conclusion</a></li>
</ul>
<section id="introduction" class="level2">
<h2 class="anchored" data-anchor-id="introduction">Introduction</h2>
<p>In this simulation we explore the question - What is the impact of insertion bias on the minimum fitness of a population during the invasion of transposable elements (TEs)?</p>
</section>
<section id="materials-methods" class="level2">
<h2 class="anchored" data-anchor-id="materials-methods">Materials &amp; Methods</h2>
<p>version: invadego0.1.3</p>
<section id="commands-for-the-simulation" class="level3">
<h3 class="anchored" data-anchor-id="commands-for-the-simulation">Commands for the simulation</h3>
<p>The simulations were generated using the code from:</p>
<ul>
<li><a href="./Simulation-Results_Files/simulation_storm/minfit/sim_storm.py">sim_storm.py</a></li>
</ul>
</section>
<section id="parameters" class="level3">
<h3 class="anchored" data-anchor-id="parameters">Parameters</h3>
<p>Simulations were ran with the following parameters:</p>
<ul>
<li>Number of simulations: 10000</li>
<li>Number of threads: 4</li>
<li>Number of replications (–rep): 1</li>
<li>Transposition rate (–u): Variable</li>
<li>Number of steps (–steps): 5000</li>
<li>Population size (–N): 1000</li>
<li>Number of generations (–gen): 5000</li>
<li>Negative effect of a TE insertion (–x): 0.01</li>
<li>Genome (–genome) mb:10,10,10,10,10</li>
<li>Recombination Rate (–rr): 4,4,4,4,4</li>
<li>Negative effect of a cluster insertions (-no-x-cluins, i.e, x=0)</li>
<li>Silent mode: True</li>
</ul>
<p>Random Clusters were Generated using this snippet:</p>
<details>
<summary>
Code
</summary>
<div class="sourceCode" id="cb1"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb1-1"><a href="#cb1-1" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> get_rand_clusters(): </span>
<span id="cb1-2"><a href="#cb1-2" aria-hidden="true" tabindex="-1"></a>    lower_limit <span class="op">=</span> <span class="dv">0</span>  <span class="co"># Lower bound</span></span>
<span id="cb1-3"><a href="#cb1-3" aria-hidden="true" tabindex="-1"></a>    upper_limit <span class="op">=</span> math.log10(<span class="fl">1e+7</span>)  <span class="co"># Upper bound</span></span>
<span id="cb1-4"><a href="#cb1-4" aria-hidden="true" tabindex="-1"></a>    r <span class="op">=</span> math.floor(<span class="dv">10</span><span class="op">**</span>random.uniform(lower_limit, upper_limit))</span>
<span id="cb1-5"><a href="#cb1-5" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> <span class="ss">f"</span><span class="sc">{</span>r<span class="sc">}</span><span class="ss">,</span><span class="sc">{</span>r<span class="sc">}</span><span class="ss">,</span><span class="sc">{</span>r<span class="sc">}</span><span class="ss">,</span><span class="sc">{</span>r<span class="sc">}</span><span class="ss">,</span><span class="sc">{</span>r<span class="sc">}</span><span class="ss">"</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</section>
</section>
<section id="visualization-in-r" class="level2">
<h2 class="anchored" data-anchor-id="visualization-in-r">Visualization in R</h2>
<section id="set-the-environment-by-loading-modules" class="level3">
<h3 class="anchored" data-anchor-id="set-the-environment-by-loading-modules">Set the environment by loading modules</h3>
<details>
<summary>
Code
</summary>
<div class="sourceCode" id="cb2"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb2-1"><a href="#cb2-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(tidyverse)</span>
<span id="cb2-2"><a href="#cb2-2" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(ggplot2)</span>
<span id="cb2-3"><a href="#cb2-3" aria-hidden="true" tabindex="-1"></a><span class="fu">theme_set</span>(<span class="fu">theme_bw</span>())</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</section>
<section id="load-data" class="level3">
<h3 class="anchored" data-anchor-id="load-data">Load Data</h3>
<details>
<summary>
Code
</summary>
<div class="sourceCode" id="cb3"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb3-1"><a href="#cb3-1" aria-hidden="true" tabindex="-1"></a>load_data <span class="ot">&lt;-</span> <span class="cf">function</span>(folder_path, u_value) {</span>
<span id="cb3-2"><a href="#cb3-2" aria-hidden="true" tabindex="-1"></a>  column_names <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">"rep"</span>, <span class="st">"gen"</span>, <span class="st">"popstat"</span>, <span class="st">"spacer_1"</span>, <span class="st">"fwte"</span>, <span class="st">"avw"</span>, <span class="st">"min_w"</span>, <span class="st">"avtes"</span>, <span class="st">"avpopfreq"</span>, <span class="st">"fixed"</span>, <span class="st">"spacer_2"</span>, <span class="st">"phase"</span>, <span class="st">"fwcli"</span>, <span class="st">"avcli"</span>, <span class="st">"fixcli"</span>, <span class="st">"spacer_3"</span>, <span class="st">"avbias"</span>, <span class="st">"3tot"</span>, <span class="st">"3cluster"</span>, <span class="st">"spacer_4"</span>, <span class="st">"sampleid"</span>)</span>
<span id="cb3-3"><a href="#cb3-3" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb3-4"><a href="#cb3-4" aria-hidden="true" tabindex="-1"></a>  df <span class="ot">&lt;-</span> <span class="fu">read_delim</span>(folder_path, <span class="at">delim=</span><span class="st">'</span><span class="sc">\t</span><span class="st">'</span>, <span class="at">col_names =</span> column_names, <span class="at">show_col_types =</span> <span class="cn">FALSE</span>)</span>
<span id="cb3-5"><a href="#cb3-5" aria-hidden="true" tabindex="-1"></a>  numeric_columns <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">"rep"</span>, <span class="st">"gen"</span>, <span class="st">"fwte"</span>, <span class="st">"avw"</span>, <span class="st">"min_w"</span>, <span class="st">"avtes"</span>, <span class="st">"avpopfreq"</span>, <span class="st">"fixed"</span>, <span class="st">"fwcli"</span>, <span class="st">"avcli"</span>, <span class="st">"fixcli"</span>, <span class="st">"avbias"</span>, <span class="st">"sampleid"</span>)</span>
<span id="cb3-6"><a href="#cb3-6" aria-hidden="true" tabindex="-1"></a>  df[numeric_columns] <span class="ot">&lt;-</span> <span class="fu">lapply</span>(df[numeric_columns], as.numeric)</span>
<span id="cb3-7"><a href="#cb3-7" aria-hidden="true" tabindex="-1"></a>  df_gen_not0 <span class="ot">&lt;-</span> df <span class="sc">%&gt;%</span> <span class="fu">filter</span>(gen <span class="sc">!=</span> <span class="dv">0</span>)</span>
<span id="cb3-8"><a href="#cb3-8" aria-hidden="true" tabindex="-1"></a>  df_gen_0 <span class="ot">&lt;-</span> df <span class="sc">%&gt;%</span> <span class="fu">filter</span>(gen <span class="sc">==</span> <span class="dv">0</span>)</span>
<span id="cb3-9"><a href="#cb3-9" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb3-10"><a href="#cb3-10" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb3-11"><a href="#cb3-11" aria-hidden="true" tabindex="-1"></a>  <span class="do">#### Join dataframes</span></span>
<span id="cb3-12"><a href="#cb3-12" aria-hidden="true" tabindex="-1"></a>  df_final <span class="ot">&lt;-</span> <span class="fu">left_join</span>(df_gen_not0, df_gen_0, <span class="at">by =</span> <span class="st">"rep"</span>, <span class="at">suffix =</span> <span class="fu">c</span>(<span class="st">""</span>, <span class="st">"_from_gen0"</span>))</span>
<span id="cb3-13"><a href="#cb3-13" aria-hidden="true" tabindex="-1"></a>  columns_to_fill <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">"popstat"</span>, <span class="st">"avbias"</span>, <span class="st">"sampleid"</span>, <span class="st">"min_w"</span>)</span>
<span id="cb3-14"><a href="#cb3-14" aria-hidden="true" tabindex="-1"></a>  <span class="cf">for</span> (col <span class="cf">in</span> columns_to_fill) {</span>
<span id="cb3-15"><a href="#cb3-15" aria-hidden="true" tabindex="-1"></a>    df_final[[col]] <span class="ot">&lt;-</span> <span class="fu">ifelse</span>(<span class="fu">is.na</span>(df_final[[col]]), df_final[[<span class="fu">paste</span>(col, <span class="st">"_from_gen0"</span>, <span class="at">sep =</span> <span class="st">""</span>)]], df_final[[col]])</span>
<span id="cb3-16"><a href="#cb3-16" aria-hidden="true" tabindex="-1"></a>  }</span>
<span id="cb3-17"><a href="#cb3-17" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb3-18"><a href="#cb3-18" aria-hidden="true" tabindex="-1"></a>  <span class="do">#### Keep only the necessary columns</span></span>
<span id="cb3-19"><a href="#cb3-19" aria-hidden="true" tabindex="-1"></a>  df_final <span class="ot">&lt;-</span> <span class="fu">select</span>(df_final, rep, popstat, avbias, sampleid, min_w)</span>
<span id="cb3-20"><a href="#cb3-20" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb3-21"><a href="#cb3-21" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Calculate sampleid_percent</span></span>
<span id="cb3-22"><a href="#cb3-22" aria-hidden="true" tabindex="-1"></a>  df_final<span class="sc">$</span>sampleid_percent <span class="ot">&lt;-</span> (df_final<span class="sc">$</span>sampleid <span class="sc">/</span> <span class="dv">10000000</span>) <span class="sc">*</span> <span class="dv">100</span> <span class="do">## At the time of writing this code the piRNA Cluster was generated in base pairs, now it is generated in kb. So to replicate this one should use 10000/1000 instead of 10000000 to divide.</span></span>
<span id="cb3-23"><a href="#cb3-23" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb3-24"><a href="#cb3-24" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Filter out fail-0 and fail-w</span></span>
<span id="cb3-25"><a href="#cb3-25" aria-hidden="true" tabindex="-1"></a>  df_filtered <span class="ot">=</span> df_final <span class="sc">%&gt;%</span> <span class="fu">filter</span>(<span class="sc">!</span>popstat <span class="sc">%in%</span> <span class="fu">c</span>(<span class="st">"fail-0"</span>, <span class="st">"fail-w"</span>))</span>
<span id="cb3-26"><a href="#cb3-26" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb3-27"><a href="#cb3-27" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Add a new column for transposition rate</span></span>
<span id="cb3-28"><a href="#cb3-28" aria-hidden="true" tabindex="-1"></a>  df_final<span class="sc">$</span>u <span class="ot">&lt;-</span> u_value</span>
<span id="cb3-29"><a href="#cb3-29" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb3-30"><a href="#cb3-30" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Also add the 'u' column to df_filtered</span></span>
<span id="cb3-31"><a href="#cb3-31" aria-hidden="true" tabindex="-1"></a>  df_filtered<span class="sc">$</span>u <span class="ot">&lt;-</span> u_value</span>
<span id="cb3-32"><a href="#cb3-32" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb3-33"><a href="#cb3-33" aria-hidden="true" tabindex="-1"></a>  <span class="fu">return</span>(<span class="fu">list</span>(<span class="at">df_final =</span> df_final, <span class="at">df_filtered =</span> df_filtered))</span>
<span id="cb3-34"><a href="#cb3-34" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb3-35"><a href="#cb3-35" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb3-36"><a href="#cb3-36" aria-hidden="true" tabindex="-1"></a><span class="co"># Load Data from Different Folders</span></span>
<span id="cb3-37"><a href="#cb3-37" aria-hidden="true" tabindex="-1"></a>df1 <span class="ot">&lt;-</span> <span class="fu">load_data</span>(<span class="st">'Simulation-Results_Files/simulation_storm/minfit/13thSep23at104054PM/combined.txt'</span>, <span class="fl">0.02</span>)</span>
<span id="cb3-38"><a href="#cb3-38" aria-hidden="true" tabindex="-1"></a>df2 <span class="ot">&lt;-</span> <span class="fu">load_data</span>(<span class="st">'Simulation-Results_Files/simulation_storm/minfit/14thSep23at113630PM/combined.txt'</span>, <span class="fl">0.01</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</section>
<section id="ggplot-function-to-plot-data" class="level3">
<h3 class="anchored" data-anchor-id="ggplot-function-to-plot-data">ggplot function to Plot Data</h3>
<details>
<summary>
Code
</summary>
<div class="sourceCode" id="cb4"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb4-1"><a href="#cb4-1" aria-hidden="true" tabindex="-1"></a>plot_data <span class="ot">&lt;-</span> <span class="cf">function</span>(df_list) {</span>
<span id="cb4-2"><a href="#cb4-2" aria-hidden="true" tabindex="-1"></a>  df_final <span class="ot">=</span> df_list<span class="sc">$</span>df_final <span class="sc">%&gt;%</span> <span class="fu">filter</span>(sampleid_percent <span class="sc">&gt;</span> <span class="fl">0.001</span>)</span>
<span id="cb4-3"><a href="#cb4-3" aria-hidden="true" tabindex="-1"></a>  df_cluster_filtered <span class="ot">=</span> df_list<span class="sc">$</span>df_filtered <span class="sc">%&gt;%</span> <span class="fu">filter</span>(sampleid_percent <span class="sc">&gt;</span> <span class="fl">0.001</span>)</span>
<span id="cb4-4"><a href="#cb4-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb4-5"><a href="#cb4-5" aria-hidden="true" tabindex="-1"></a>  breaks <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="fl">0.01</span>, <span class="fl">0.1</span>, <span class="fl">0.33</span>, <span class="fl">0.66</span>, <span class="dv">1</span>)</span>
<span id="cb4-6"><a href="#cb4-6" aria-hidden="true" tabindex="-1"></a>  colors <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">"darkred"</span>, <span class="st">"red"</span>, <span class="st">"yellow"</span>, <span class="st">"lightgreen"</span>, <span class="st">"green"</span>)</span>
<span id="cb4-7"><a href="#cb4-7" aria-hidden="true" tabindex="-1"></a>  plot <span class="ot">&lt;-</span> <span class="fu">ggplot</span>(df_cluster_filtered, <span class="fu">aes</span>(<span class="at">x =</span> sampleid_percent, <span class="at">y =</span> avbias, <span class="at">color =</span> min_w)) <span class="sc">+</span></span>
<span id="cb4-8"><a href="#cb4-8" aria-hidden="true" tabindex="-1"></a>    <span class="fu">geom_point</span>(<span class="at">alpha =</span> <span class="fl">0.7</span>, <span class="at">size =</span> <span class="fl">0.8</span>) <span class="sc">+</span></span>
<span id="cb4-9"><a href="#cb4-9" aria-hidden="true" tabindex="-1"></a>    <span class="fu">geom_point</span>(<span class="at">data =</span> df_final <span class="sc">%&gt;%</span> <span class="fu">filter</span>(popstat <span class="sc">==</span> <span class="st">"fail-0"</span>), <span class="fu">aes</span>(<span class="at">x =</span> sampleid_percent, <span class="at">y =</span> avbias), <span class="at">color =</span> <span class="st">"darkgreen"</span>, <span class="at">alpha =</span> <span class="fl">0.7</span>, <span class="at">size =</span> <span class="fl">0.8</span>) <span class="sc">+</span></span>
<span id="cb4-10"><a href="#cb4-10" aria-hidden="true" tabindex="-1"></a>    <span class="fu">geom_point</span>(<span class="at">data =</span> df_final <span class="sc">%&gt;%</span> <span class="fu">filter</span>(popstat <span class="sc">==</span> <span class="st">"fail-w"</span>), <span class="fu">aes</span>(<span class="at">x =</span> sampleid_percent, <span class="at">y =</span> avbias), <span class="at">color =</span> <span class="st">"darkgrey"</span>, <span class="at">alpha =</span> <span class="fl">0.3</span>, <span class="at">size =</span> <span class="fl">0.75</span>) <span class="sc">+</span></span>
<span id="cb4-11"><a href="#cb4-11" aria-hidden="true" tabindex="-1"></a>    <span class="fu">ylab</span>(<span class="st">"Average Bias in TE Insertion"</span>) <span class="sc">+</span></span>
<span id="cb4-12"><a href="#cb4-12" aria-hidden="true" tabindex="-1"></a>    <span class="fu">xlab</span>(<span class="st">"Cluster Size (% of 10 Mb Genome)"</span>) <span class="sc">+</span></span>
<span id="cb4-13"><a href="#cb4-13" aria-hidden="true" tabindex="-1"></a>    <span class="fu">labs</span>(</span>
<span id="cb4-14"><a href="#cb4-14" aria-hidden="true" tabindex="-1"></a>      <span class="at">title =</span> <span class="st">"Cluster Size (% of 10 Mb Genome) vs Average Bias"</span>,</span>
<span id="cb4-15"><a href="#cb4-15" aria-hidden="true" tabindex="-1"></a>      <span class="at">subtitle =</span> <span class="fu">paste</span>(<span class="st">"Minimum Fitness by Color | Transposition rate (–u):"</span>, <span class="fu">unique</span>(df_final<span class="sc">$</span>u))</span>
<span id="cb4-16"><a href="#cb4-16" aria-hidden="true" tabindex="-1"></a>    ) <span class="sc">+</span></span>
<span id="cb4-17"><a href="#cb4-17" aria-hidden="true" tabindex="-1"></a>    <span class="fu">scale_color_gradientn</span>(</span>
<span id="cb4-18"><a href="#cb4-18" aria-hidden="true" tabindex="-1"></a>      <span class="at">name =</span> <span class="st">"Minimum Fitness of the Population"</span>,</span>
<span id="cb4-19"><a href="#cb4-19" aria-hidden="true" tabindex="-1"></a>      <span class="at">breaks =</span> breaks,</span>
<span id="cb4-20"><a href="#cb4-20" aria-hidden="true" tabindex="-1"></a>      <span class="at">colors =</span> colors</span>
<span id="cb4-21"><a href="#cb4-21" aria-hidden="true" tabindex="-1"></a>    ) <span class="sc">+</span></span>
<span id="cb4-22"><a href="#cb4-22" aria-hidden="true" tabindex="-1"></a>    <span class="fu">scale_x_log10</span>(</span>
<span id="cb4-23"><a href="#cb4-23" aria-hidden="true" tabindex="-1"></a>      <span class="at">breaks =</span> <span class="fu">c</span>(<span class="fl">0.001</span>, <span class="fl">0.01</span>, <span class="fl">0.1</span>, <span class="dv">1</span>, <span class="dv">10</span>),</span>
<span id="cb4-24"><a href="#cb4-24" aria-hidden="true" tabindex="-1"></a>      <span class="at">labels =</span> <span class="fu">c</span>(<span class="st">"0.001%"</span>, <span class="st">"0.01%"</span>, <span class="st">"0.1%"</span>, <span class="st">"1%"</span>, <span class="st">"10%"</span>)</span>
<span id="cb4-25"><a href="#cb4-25" aria-hidden="true" tabindex="-1"></a>    ) <span class="sc">+</span></span>
<span id="cb4-26"><a href="#cb4-26" aria-hidden="true" tabindex="-1"></a>    <span class="fu">theme_minimal</span>() <span class="sc">+</span></span>
<span id="cb4-27"><a href="#cb4-27" aria-hidden="true" tabindex="-1"></a>    <span class="fu">theme</span>(</span>
<span id="cb4-28"><a href="#cb4-28" aria-hidden="true" tabindex="-1"></a>      <span class="at">legend.position =</span> <span class="st">"bottom"</span>,</span>
<span id="cb4-29"><a href="#cb4-29" aria-hidden="true" tabindex="-1"></a>      <span class="at">panel.background =</span> <span class="fu">element_rect</span>(<span class="at">fill =</span> <span class="st">"grey90"</span>)</span>
<span id="cb4-30"><a href="#cb4-30" aria-hidden="true" tabindex="-1"></a>    ) </span>
<span id="cb4-31"><a href="#cb4-31" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb4-32"><a href="#cb4-32" aria-hidden="true" tabindex="-1"></a>  <span class="fu">return</span>(plot)</span>
<span id="cb4-33"><a href="#cb4-33" aria-hidden="true" tabindex="-1"></a>}</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</section>
<section id="create-the-plots" class="level3">
<h3 class="anchored" data-anchor-id="create-the-plots">Create the plots</h3>
<details>
<summary>
Code
</summary>
<div class="sourceCode" id="cb5"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb5-1"><a href="#cb5-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Save the final plot</span></span>
<span id="cb5-2"><a href="#cb5-2" aria-hidden="true" tabindex="-1"></a>plot1 <span class="ot">&lt;-</span> <span class="fu">plot_data</span>(df1)</span>
<span id="cb5-3"><a href="#cb5-3" aria-hidden="true" tabindex="-1"></a><span class="fu">ggsave</span>(<span class="at">filename =</span> <span class="st">"images/minimum_fitness_u02.jpg"</span>, <span class="at">plot =</span> plot1, <span class="at">width =</span> <span class="dv">10</span>, <span class="at">height =</span> <span class="dv">6</span>)</span>
<span id="cb5-4"><a href="#cb5-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb5-5"><a href="#cb5-5" aria-hidden="true" tabindex="-1"></a>plot2 <span class="ot">&lt;-</span> <span class="fu">plot_data</span>(df2)</span>
<span id="cb5-6"><a href="#cb5-6" aria-hidden="true" tabindex="-1"></a><span class="fu">ggsave</span>(<span class="at">filename =</span> <span class="st">"images/minimum_fitness_u01.jpg"</span>, <span class="at">plot =</span> plot2, <span class="at">width =</span> <span class="dv">10</span>, <span class="at">height =</span> <span class="dv">6</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<p><img src="images/minimum_fitness_u01.jpg" class="img-fluid" alt="Minimum Fitness at u = 0.1"> <img src="images/minimum_fitness_u02.jpg" class="img-fluid" alt="Minimum Fitness at u = 0.2"></p>
</section>
</section>
<section id="color-scheme-in-the-plot" class="level2">
<h2 class="anchored" data-anchor-id="color-scheme-in-the-plot">Color Scheme in the Plot</h2>
<p>The color scheme used in the plot serves to represent different categories and values effectively:</p>
<section id="variable---min_w" class="level3">
<h3 class="anchored" data-anchor-id="variable---min_w">Variable - <code>min_w</code></h3>
<p>For <code>min_w</code>, we have used a gradient of colors as follows:</p>
<ul>
<li><strong>Dark Red (0.01)</strong>: Represents <span class="math inline">\(min\_w &lt; 0.01\)</span></li>
<li><strong>Red (0.1)</strong>: Represents <span class="math inline">\(min\_w &lt; 0.1\)</span></li>
<li><strong>Yellow (0.33)</strong>: Represents <span class="math inline">\(min\_w &lt; 0.33\)</span></li>
<li><strong>Green (1)</strong>: Represents <span class="math inline">\(min\_w = 11\)</span></li>
</ul>
<p>These colors visually guide the viewer through varying levels of fitness from lowest to highest.</p>
</section>
<section id="variables---popstat" class="level3">
<h3 class="anchored" data-anchor-id="variables---popstat">Variables - <code>popstat</code></h3>
<p>Points where the <code>popstat</code> is either “fail-0” or “fail-w”. These are represented by:</p>
<ul>
<li><strong>Dark Green (<code>fail-0</code>)</strong>: Indicates no TEs are left in the population.</li>
<li><strong>Dark Grey (<code>fail-w</code>)</strong>: Indicates that population fitness is too low.</li>
</ul>
</section>
</section>
<section id="conclusion" class="level2">
<h2 class="anchored" data-anchor-id="conclusion">Conclusion</h2>
<p>According to Kofler[2020], piRNA clusters require a minimum size to control transposable element invasions. These clusters may comprise up to 3% of the genome in small populations, especially with high transposition rates and recessive TE insertions. Here, we observe that the compensation for lower cluster size comes through increased insertion bias into the piRNA clusters. The population fitness increases with cluster size and average bias; negative bias results in extinction even with a large cluster size.</p>
<p>Another noticeable thing from the plot is that the change in transposition rate has little effect on population fitness if they have an appropriate cluster size with a strong enough bias.</p>
<hr>
<p><cite><a href="https://doi.org/10.1093/gbe/evaa064">Robert Kofler, “piRNA Clusters Need a Minimum Size to Control Transposable Element Invasions,” Genome Biology and Evolution, Volume 12, Issue 5, May 2020, Pages 736–749</a></cite></p>
</section>
</section>

</main>
<!-- /main column -->
<script id="quarto-html-after-body" type="application/javascript">
window.document.addEventListener("DOMContentLoaded", function (event) {
  const toggleBodyColorMode = (bsSheetEl) => {
    const mode = bsSheetEl.getAttribute("data-mode");
    const bodyEl = window.document.querySelector("body");
    if (mode === "dark") {
      bodyEl.classList.add("quarto-dark");
      bodyEl.classList.remove("quarto-light");
    } else {
      bodyEl.classList.add("quarto-light");
      bodyEl.classList.remove("quarto-dark");
    }
  }
  const toggleBodyColorPrimary = () => {
    const bsSheetEl = window.document.querySelector("link#quarto-bootstrap");
    if (bsSheetEl) {
      toggleBodyColorMode(bsSheetEl);
    }
  }
  toggleBodyColorPrimary();  
  const icon = "";
  const anchorJS = new window.AnchorJS();
  anchorJS.options = {
    placement: 'right',
    icon: icon
  };
  anchorJS.add('.anchored');
  const isCodeAnnotation = (el) => {
    for (const clz of el.classList) {
      if (clz.startsWith('code-annotation-')) {                     
        return true;
      }
    }
    return false;
  }
  const clipboard = new window.ClipboardJS('.code-copy-button', {
    text: function(trigger) {
      const codeEl = trigger.previousElementSibling.cloneNode(true);
      for (const childEl of codeEl.children) {
        if (isCodeAnnotation(childEl)) {
          childEl.remove();
        }
      }
      return codeEl.innerText;
    }
  });
  clipboard.on('success', function(e) {
    // button target
    const button = e.trigger;
    // don't keep focus
    button.blur();
    // flash "checked"
    button.classList.add('code-copy-button-checked');
    var currentTitle = button.getAttribute("title");
    button.setAttribute("title", "Copied!");
    let tooltip;
    if (window.bootstrap) {
      button.setAttribute("data-bs-toggle", "tooltip");
      button.setAttribute("data-bs-placement", "left");
      button.setAttribute("data-bs-title", "Copied!");
      tooltip = new bootstrap.Tooltip(button, 
        { trigger: "manual", 
          customClass: "code-copy-button-tooltip",
          offset: [0, -8]});
      tooltip.show();    
    }
    setTimeout(function() {
      if (tooltip) {
        tooltip.hide();
        button.removeAttribute("data-bs-title");
        button.removeAttribute("data-bs-toggle");
        button.removeAttribute("data-bs-placement");
      }
      button.setAttribute("title", currentTitle);
      button.classList.remove('code-copy-button-checked');
    }, 1000);
    // clear code selection
    e.clearSelection();
  });
  function tippyHover(el, contentFn) {
    const config = {
      allowHTML: true,
      content: contentFn,
      maxWidth: 500,
      delay: 100,
      arrow: false,
      appendTo: function(el) {
          return el.parentElement;
      },
      interactive: true,
      interactiveBorder: 10,
      theme: 'quarto',
      placement: 'bottom-start'
    };
    window.tippy(el, config); 
  }
  const noterefs = window.document.querySelectorAll('a[role="doc-noteref"]');
  for (var i=0; i<noterefs.length; i++) {
    const ref = noterefs[i];
    tippyHover(ref, function() {
      // use id or data attribute instead here
      let href = ref.getAttribute('data-footnote-href') || ref.getAttribute('href');
      try { href = new URL(href).hash; } catch {}
      const id = href.replace(/^#\/?/, "");
      const note = window.document.getElementById(id);
      return note.innerHTML;
    });
  }
      let selectedAnnoteEl;
      const selectorForAnnotation = ( cell, annotation) => {
        let cellAttr = 'data-code-cell="' + cell + '"';
        let lineAttr = 'data-code-annotation="' +  annotation + '"';
        const selector = 'span[' + cellAttr + '][' + lineAttr + ']';
        return selector;
      }
      const selectCodeLines = (annoteEl) => {
        const doc = window.document;
        const targetCell = annoteEl.getAttribute("data-target-cell");
        const targetAnnotation = annoteEl.getAttribute("data-target-annotation");
        const annoteSpan = window.document.querySelector(selectorForAnnotation(targetCell, targetAnnotation));
        const lines = annoteSpan.getAttribute("data-code-lines").split(",");
        const lineIds = lines.map((line) => {
          return targetCell + "-" + line;
        })
        let top = null;
        let height = null;
        let parent = null;
        if (lineIds.length > 0) {
            //compute the position of the single el (top and bottom and make a div)
            const el = window.document.getElementById(lineIds[0]);
            top = el.offsetTop;
            height = el.offsetHeight;
            parent = el.parentElement.parentElement;
          if (lineIds.length > 1) {
            const lastEl = window.document.getElementById(lineIds[lineIds.length - 1]);
            const bottom = lastEl.offsetTop + lastEl.offsetHeight;
            height = bottom - top;
          }
          if (top !== null && height !== null && parent !== null) {
            // cook up a div (if necessary) and position it 
            let div = window.document.getElementById("code-annotation-line-highlight");
            if (div === null) {
              div = window.document.createElement("div");
              div.setAttribute("id", "code-annotation-line-highlight");
              div.style.position = 'absolute';
              parent.appendChild(div);
            }
            div.style.top = top - 2 + "px";
            div.style.height = height + 4 + "px";
            let gutterDiv = window.document.getElementById("code-annotation-line-highlight-gutter");
            if (gutterDiv === null) {
              gutterDiv = window.document.createElement("div");
              gutterDiv.setAttribute("id", "code-annotation-line-highlight-gutter");
              gutterDiv.style.position = 'absolute';
              const codeCell = window.document.getElementById(targetCell);
              const gutter = codeCell.querySelector('.code-annotation-gutter');
              gutter.appendChild(gutterDiv);
            }
            gutterDiv.style.top = top - 2 + "px";
            gutterDiv.style.height = height + 4 + "px";
          }
          selectedAnnoteEl = annoteEl;
        }
      };
      const unselectCodeLines = () => {
        const elementsIds = ["code-annotation-line-highlight", "code-annotation-line-highlight-gutter"];
        elementsIds.forEach((elId) => {
          const div = window.document.getElementById(elId);
          if (div) {
            div.remove();
          }
        });
        selectedAnnoteEl = undefined;
      };
      // Attach click handler to the DT
      const annoteDls = window.document.querySelectorAll('dt[data-target-cell]');
      for (const annoteDlNode of annoteDls) {
        annoteDlNode.addEventListener('click', (event) => {
          const clickedEl = event.target;
          if (clickedEl !== selectedAnnoteEl) {
            unselectCodeLines();
            const activeEl = window.document.querySelector('dt[data-target-cell].code-annotation-active');
            if (activeEl) {
              activeEl.classList.remove('code-annotation-active');
            }
            selectCodeLines(clickedEl);
            clickedEl.classList.add('code-annotation-active');
          } else {
            // Unselect the line
            unselectCodeLines();
            clickedEl.classList.remove('code-annotation-active');
          }
        });
      }
  const findCites = (el) => {
    const parentEl = el.parentElement;
    if (parentEl) {
      const cites = parentEl.dataset.cites;
      if (cites) {
        return {
          el,
          cites: cites.split(' ')
        };
      } else {
        return findCites(el.parentElement)
      }
    } else {
      return undefined;
    }
  };
  var bibliorefs = window.document.querySelectorAll('a[role="doc-biblioref"]');
  for (var i=0; i<bibliorefs.length; i++) {
    const ref = bibliorefs[i];
    const citeInfo = findCites(ref);
    if (citeInfo) {
      tippyHover(citeInfo.el, function() {
        var popup = window.document.createElement('div');
        citeInfo.cites.forEach(function(cite) {
          var citeDiv = window.document.createElement('div');
          citeDiv.classList.add('hanging-indent');
          citeDiv.classList.add('csl-entry');
          var biblioDiv = window.document.getElementById('ref-' + cite);
          if (biblioDiv) {
            citeDiv.innerHTML = biblioDiv.innerHTML;
          }
          popup.appendChild(citeDiv);
        });
        return popup.innerHTML;
      });
    }
  }
});
</script>
</div> <!-- /content -->



</body></html>