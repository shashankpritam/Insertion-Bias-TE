---
title: "Minimum Fitness"
author: Shashank Pritam
listing: default
toc: true
number-sections: true
highlight-style: pygments
format: 
  gfm: 
    code-fold: true
    html-math-method: katex
---

## Introduction

What is the impact of insertion bias on the minimum fitness of a population during the invasion of transposable elements (TEs), within the parameter space of bias and cluster size?

### Initial conditions


## Materials & Methods

version: invadego0.1.3

### Commands for the simulation

The simulations were generated using the code from:

- [sim_storm.py](sim_storm.py)


## Visualization in R

#### Setting the environment
```{r}
library(tidyverse)
library(RColorBrewer)
library(ggplot2)
library(patchwork)
library(dplyr)
theme_set(theme_bw())
```


#### Data loading and parsing
```{r}

# Define and load DataFrame with column names
column_names <- c("rep", "gen", "popstat", "spacer_1", "fwte", "avw", "min_w", "avtes", "avpopfreq", "fixed", "spacer_2", "phase", "fwcli", "avcli", "fixcli", "spacer_3", "avbias", "3tot", "3cluster", "spacer_4", "sampleid")
df <- read_delim('/Users/shashankpritam/github/Insertion-Bias-TE/Simulation-Results_Files/simulation_storm/21thAug23at045659PM/combined.txt', delim='\t', col_names = column_names)

# Convert specific columns to numeric
numeric_columns <- c("rep", "gen", "fwte", "avw", "min_w", "avtes", "avpopfreq", "fixed", "fwcli", "avcli", "fixcli", "avbias", "sampleid")
df[numeric_columns] <- lapply(df[numeric_columns], as.numeric)
```

### Data Loading
```{r}
# Define color gradient functions
color.gradient <- function(x, colors=c("#D7191C","#FDAE61","#A6D96A","#1A9641"), colsteps=100) { colorRampPalette(colors) (colsteps) [ findInterval(x, seq(min(df$min_w),1.0, length.out=colsteps)) ] }

# Assign colors based on the 'min_w' column
df$col <- color.gradient(df$min_w)
df[df$popstat == "fail-0",]$col <- "grey"
df$col <- as.factor(df$col)

# Create and plot the ggplot object
# Subset the data for gen 5000
df_gen_5000 <- df[df$gen == 5000,]
```

### Plot 1
```{r}
# Plot avbias vs sampleid (Cluster Size) with min_w as color
g_avbias_cluster_size <- ggplot(df_gen_5000, aes(x = avbias, y = sampleid, color = min_w)) +
  geom_point(alpha = 0.7, size = 0.8) +
  ylab("Cluster Size") +
  xlab("Average Bias in TE Insertion") +
  labs(title = "Cluster Size vs Average Bias at gen 5000",
       subtitle = "Different min_w values represented by colors") +
  scale_color_gradient(name = "min_w") +
  theme_minimal() +
  theme(legend.position = "bottom", panel.background = element_rect(fill="grey90"))

# Display the plot
plot(g_avbias_cluster_size)
```

### Plot 2
